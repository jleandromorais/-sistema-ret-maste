# ğŸš€ Sistema RET Master

[![Python](https://img.shields.io/badge/Python-3.14-blue.svg)](https://python.org)
[![CustomTkinter](https://img.shields.io/badge/CustomTkinter-5.2+-green.svg)](https://github.com/TomSchimansky/CustomTkinter)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-2.0-orange.svg)](CHANGELOG.md)

> **Sistema moderno e profissional para processamento automatizado de PDFs de RET (Receita de Encargos e Tarifas)**

Interface grÃ¡fica avanÃ§ada com CustomTkinter, extraÃ§Ã£o inteligente de dados e exportaÃ§Ã£o para Excel profissionalmente formatado.

---

## ğŸ“¸ Preview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš€ Sistema RET Master    Processamento Automatizado        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SELEÃ‡ÃƒO       â”‚  RESULTADOS                              â”‚
â”‚                â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  ğŸ“ Pasta      â”‚  â”‚ Resumo â”‚ Dados â”‚ Logs â”‚       â”‚      â”‚
â”‚  â˜‘ EAT         â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â˜‘ Penalidades â”‚  â”‚  PDFs: 35                      â”‚      â”‚
â”‚  â˜‘ TOP         â”‚  â”‚  Valores: 261                  â”‚      â”‚
â”‚                â”‚  â”‚  Total: EUR 92M+               â”‚      â”‚
â”‚  â–¶ PROCESSAR   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° TOTAL: EUR 92,036,573.52    ğŸ’¾ Salvar  ğŸ“Š Exportar    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ¨ Funcionalidades Principais

### ğŸ¨ Interface Moderna
- Design escuro e profissional com CustomTkinter
- Layout intuitivo com painÃ©is organizados
- VisualizaÃ§Ã£o em tempo real do processamento
- Sistema de abas para diferentes visualizaÃ§Ãµes

### ğŸ“Š Processamento Inteligente
- ExtraÃ§Ã£o automÃ¡tica de dados estruturados dos PDFs
- IdentificaÃ§Ã£o automÃ¡tica de:
  - âœ… Tipo de Encargo (EAT, Penalidades, TOP)
  - âœ… Empresa
  - âœ… Tipo de Nota (DÃ©bito/CrÃ©dito)
  - âœ… NÃºmero da ND
  - âœ… Data de Vencimento
  - âœ… Valor Total
  - âœ… Quantidade (QT)
  - âœ… Valor UnitÃ¡rio

### ğŸ“ Arquivos Gerados

#### 1. Excel Profissional (RET_Relatorio.xlsx)
Arquivo Excel com **formataÃ§Ã£o profissional** contendo 3 abas:

**ğŸ“‹ Dados Completos**
- Tabela completa com todos os registros
- CabeÃ§alhos formatados (azul escuro com texto branco)
- Bordas em todas as cÃ©lulas
- FormataÃ§Ã£o numÃ©rica automÃ¡tica
- Larguras de coluna ajustadas
- Alinhamento centralizado

Colunas:
1. Tipo de Encargo
2. Empresa
3. Nota DÃ©bito/CrÃ©dito
4. NÂº
5. Data Vencimento
6. Valor Total
7. QT
8. Valor UnitÃ¡rio
9. Arquivo

**ğŸ“Š Resumo por Tipo**
- Agrupamento por tipo de encargo
- SomatÃ³rios automÃ¡ticos
- Contagem de arquivos
- FormataÃ§Ã£o visual destacada

**ğŸ“ˆ Resumo Geral**
- EstatÃ­sticas globais
- Total de PDFs processados
- Quantidade total
- Valor total em EUR
- Data e hora do processamento

#### 2. Banco de Dados SQLite (RET_dados.db)
Banco de dados completo com tabela `dados_ret` contendo:
- ID automÃ¡tico
- Todos os campos extraÃ­dos
- Timestamps de processamento
- Caminhos completos dos arquivos

## ğŸ¯ Como Usar

### 1. Executar o Sistema

```powershell
# Ativar ambiente virtual
.\venv\Scripts\Activate.ps1

# Executar
python Somatorio_De_Ret.py
```

### 2. Interface Principal

**Painel Esquerdo - Controles:**
- ğŸ“ **Selecionar Pasta**: Escolha a pasta raiz contendo os PDFs
- â˜‘ï¸ **Tipos de Encargo**: Marque os tipos que deseja processar
  - EAT (Encargos de Acesso e Transporte)
  - Penalidades
  - TOP (Takeoff Point)
- â–¶ï¸ **PROCESSAR PDFs**: Inicia o processamento

**Painel Direito - Resultados:**
- ğŸ“Š **Resumo**: EstatÃ­sticas gerais e por tipo
- ğŸ“‹ **Dados Detalhados**: VisualizaÃ§Ã£o tabular dos dados
- ğŸ“ **Logs**: Acompanhamento em tempo real

**RodapÃ©:**
- ğŸ’° **Total Geral**: Valor total processado em destaque
- ğŸ’¾ **Salvar no Banco**: Grava dados no SQLite
- ğŸ“Š **Exportar Excel**: Gera relatÃ³rio Excel formatado

## ğŸ¨ CaracterÃ­sticas Visuais

### Cores do Tema
- **Fundo Principal**: Escuro moderno
- **Destaques**: Azul ciano (#00d9ff)
- **BotÃ£o Processar**: Verde (#4CAF50)
- **BotÃ£o Salvar**: Roxo (#9C27B0)
- **BotÃ£o Excel**: Laranja (#FF9800)

### Tipografia
- **Fonte Principal**: Roboto
- **Logs**: Consolas (monoespaÃ§ada)
- **Tamanhos**: Responsivos (10-32pt)

## ğŸ“‹ Estrutura de Dados ExtraÃ­dos

Cada PDF processado gera um registro com:

| Campo | DescriÃ§Ã£o | Exemplo |
|-------|-----------|---------|
| **Tipo de Encargo** | EAT/Penalidades/TOP | EAT |
| **Empresa** | Nome da empresa | COPERGAS |
| **Nota DÃ©bito/CrÃ©dito** | Tipo de nota | DÃ©bito |
| **NÂº** | NÃºmero da ND | 0917167397 |
| **Data Vencimento** | Data no formato DD/MM/AAAA | 15/12/2025 |
| **Valor Total** | Valor total em EUR | 26524.62 |
| **QT** | Quantidade | 1000 |
| **Valor UnitÃ¡rio** | Valor por unidade | 26.52 |
| **Arquivo** | Nome do PDF | ND_355.pdf |

## ğŸ”§ Requisitos TÃ©cnicos

### DependÃªncias
```
pandas>=3.0.0
openpyxl>=3.1.5
pdfplumber>=0.11.9
PyPDF2>=3.0.1
customtkinter>=5.2.2
pillow>=12.1.1
darkdetect>=0.8.0
```

### InstalaÃ§Ã£o
```powershell
python -m pip install -r requirements.txt
```

## ğŸ“Š Exemplo de Processamento

### Entrada
```
C:\Desktop\RET\
â”œâ”€â”€ EAT\
â”‚   â””â”€â”€ 12 EAT dez-25\
â”‚       â””â”€â”€ Extraido\
â”‚           â”œâ”€â”€ ND_355.pdf
â”‚           â”œâ”€â”€ ND_0917167397.pdf
â”‚           â””â”€â”€ ...
â”œâ”€â”€ Penalidades\
â”‚   â””â”€â”€ 12 PEN dez-25\
â”‚       â””â”€â”€ Extraido\
â”‚           â”œâ”€â”€ AMBEV_NDPFP03808.pdf
â”‚           â””â”€â”€ ...
â””â”€â”€ TOP\
    â””â”€â”€ 12 TOP dez-25\
        â””â”€â”€ Extraido\
            â””â”€â”€ ...
```

### SaÃ­da
- âœ… **RET_Relatorio.xlsx** (Excel profissionalmente formatado)
- âœ… **RET_dados.db** (Banco de dados SQLite)
- âœ… **Logs completos** na interface
- âœ… **EstatÃ­sticas detalhadas** por tipo

## ğŸ¯ Diferenciais

### âœ¨ Interface
- âœ… Design moderno e profissional
- âœ… Dark mode nativo
- âœ… Responsiva e intuitiva
- âœ… Feedback visual em tempo real

### ğŸ“Š Excel
- âœ… FormataÃ§Ã£o profissional
- âœ… Cores e bordas
- âœ… MÃºltiplas abas organizadas
- âœ… FÃ³rmulas e totalizadores
- âœ… Larguras ajustadas automaticamente

### ğŸ” Processamento
- âœ… ExtraÃ§Ã£o inteligente de dados
- âœ… DetecÃ§Ã£o automÃ¡tica de empresas
- âœ… IdentificaÃ§Ã£o de tipos de nota
- âœ… CÃ¡lculos automÃ¡ticos
- âœ… Tratamento de erros robusto

## ğŸ› Troubleshooting

### Interface nÃ£o abre
```powershell
# Reinstalar CustomTkinter
pip install --upgrade --force-reinstall customtkinter
```

### Erros de encoding
- O sistema trata automaticamente caracteres especiais
- Logs usam formato seguro para Windows

### PDFs nÃ£o encontrados
- Verifique se a pasta selecionada contÃ©m subpastas com PDFs
- Os PDFs devem ter extensÃ£o .pdf (minÃºscula ou maiÃºscula)

## ğŸ“ InformaÃ§Ãµes

**Desenvolvido em**: Python 3.14  
**Framework UI**: CustomTkinter 5.2+  
**Data**: Fevereiro 2026  

---

## ğŸ‰ Novidades desta VersÃ£o

### v2.0 - Interface Moderna
- âœ¨ Interface completamente redesenhada com CustomTkinter
- ğŸ“Š Excel com formataÃ§Ã£o profissional
- ğŸ¨ Cores e temas modernos
- ğŸ“‹ Campos estruturados completos
- ğŸ’¾ Sistema de banco de dados aprimorado
- ğŸ“ˆ MÃºltiplas visualizaÃ§Ãµes (Resumo, Dados, Logs)
- âš¡ Performance otimizada

**Aproveite o sistema!** ğŸš€
